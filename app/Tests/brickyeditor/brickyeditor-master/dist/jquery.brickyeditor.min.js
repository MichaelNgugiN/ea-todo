var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),BrickyEditor;!function(t){var e=function(){function e(e,o,i,n){this.fields=[];this.editor=e,this.container=o,this.template=i;var r=t.Services.TemplateService.getTemplate(i);this.$block=$(r.html);var a=this.getBlockTools(this.$block);this.$editor=a,a.hover(function(){a.addClass("active")},function(){a.removeClass("active")}),this.bindBlockFields(n)}return e.prototype.getBlockTools=function(t){var e=this,i=$("<div class='brickyeditor-block-wrapper'>\n                    <div  class='brickyeditor-block-tools'>\n                        <a class='fa fa-trash-o' data-brickyeditor-block-action='"+o.Delete+"'></a>\n                        <a class='fa fa-copy' data-brickyeditor-block-action='"+o.Copy+"'></a>\n                        <a class='fa fa-angle-up' data-brickyeditor-block-action='"+o.Up+"'></a>\n                        <a class='fa fa-angle-down' data-brickyeditor-block-action='"+o.Down+"'></a>\n                    </div>\n                </div>");return $("[data-brickyeditor-block-action]",i).on("click",function(){var t=$(this).attr("data-brickyeditor-block-action");e.action(parseInt(t))}),i.append(t),i},e.prototype.action=function(t){switch(t){case o.Delete:this.container.deleteBlock(this);break;case o.Up:this.container.moveBlock(this,-1);break;case o.Down:this.container.moveBlock(this,1);break;case o.Copy:this.container.copyBlock(this)}},e.prototype.bindBlockFields=function(e){var o=this;this.$block.find(t.Constants.selectorField).addBack(t.Constants.selectorField).each(function(){var i,n=$(this),r=t.Services.TemplateService.getFieldValue(n,"name");e&&e.forEach(function(t){t.name===r&&(i=t.data)});var a=t.Fields.BaseField.getField(o,n,i);a&&o.fields.push(a)})},e.prototype.getData=function(){var t=[];return this.fields.forEach(function(e){t.push(e.getData())}),{template:this.template,html:this.getHtml(!0),fields:t}},e.prototype.getHtml=function(e,o){void 0===o&&(o=!1);var i=this.$block.clone();i.find(t.Constants.selectorField).addBack(t.Constants.selectorField).each(function(e,i){if(!o){var n=t.Common.propsFilterKeys(i.attributes,function(e,o){return o.name.breStartsWith(t.Constants.field)}).map(function(t){return i.attributes[t].name});n.push("contenteditable"),n.forEach(function(t){i.removeAttribute(t)})}});var n=i[0].outerHTML;return e?n.breTotalTrim():n},e.prototype.selectBlock=function(t,e){this.container.selectedBlock&&this.container.selectedBlock.deselectBlock(),this.container.selectedBlock=this,this.container.select(e)},e.prototype.deselectBlock=function(){this.container.deselect(this.container.selectedContainer)},e}();t.Block=e;var o;!function(t){t[t.Delete=0]="Delete",t[t.Settings=1]="Settings",t[t.Copy=2]="Copy",t[t.Up=3]="Up",t[t.Down=4]="Down"}(o||(o={}))}(BrickyEditor||(BrickyEditor={})),String.prototype.breContains=function(t){return this.indexOf(t)>=0},String.prototype.breStartsWith=function(t){return 0==this.indexOf(t)},String.prototype.breTotalTrim=function(){return this?this.replace(/\s\s+/g," ").trim():""},String.prototype.breEqualsInvariant=function(t){return this.toLowerCase()===t.toLowerCase()},Array.prototype.find||(Array.prototype.find=function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,o=Object(this),i=o.length>>>0,n=arguments[1],r=0;r<i;r++)if(e=o[r],t.call(n,e,r,o))return e});var BrickyEditor;!function(t){var e=function(){function t(){}return t.getSelectedText=function(){var t="",e=document;return window.getSelection?t=window.getSelection().toString():e.selection&&"Control"!=e.selection.type&&(t=e.selection.createRange().text),t},t.propsEach=function(t,e){for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];e(o,i)}},t.propsFilterKeys=function(e,o,i){var n=[];return t.propsEach(e,function(t,e){o(t,e)&&n.push(t)}),i&&n.push(i),n},t}();t.Common=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(){}return t}();e.templatesFolder="templates/bootstrap4",e.field="data-bricky-field",e.templateModalKey="modal",e.templateToolsKey="tools",e.templateHtmlToolsKey="htmlTools",e.selectorModalContent=".brickyeditor-modal-content",e.selectorModalClose=".brickyeditor-modal-close",e.selectorTemplates=".templates",e.selectorTemplate=".template",e.selectorCancel=".brickyeditor-cancel",e.selectorSave=".brickyeditor-save",e.selectorLoader="#brickyeditorLoader",e.selectorFilter="#brickyeditorFilter",e.selectorField="["+e.field+"]",e.selectorHtmlToolsCommand="[data-brickyeditor-doc-command]",e.selectorHtmlToolsCommandRange="[data-brickyeditor-doc-command-range]",e.selectorBlockWrapper=".brickyeditor-block-wrapper",e.classMobile="brickyeditor-tools-mobile",e.dummyText="On the other hand, we denounce with righteous indignation and dislike men who are so beguiled and demoralized by the charms of pleasure of the moment, so blinded by desire, that they cannot foresee the pain and trouble that are bound to ensue.",t.Constants=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function e(e,o){this.blocks=[],this.$el=e,o?this.editor:this instanceof t.Editor&&(this.editor=this)}return Object.defineProperty(e.prototype,"selectedContainer",{get:function(){return this._selectedContainer},set:function(t){this._selectedContainer&&this._selectedContainer!=t&&this._selectedContainer.$el.removeClass("selected"),this._selectedContainer=t,this._selectedContainer&&this._selectedContainer.$el.addClass("selected")},enumerable:!0,configurable:!0}),e.prototype.select=function(t){var e=this;this.selectedContainer=t,this.selectedContainer&&this.selectedContainer.$el.on("contextmenu",function(){return e.deselect(t),!1})},e.prototype.deselect=function(t){t&&(t.$el.off("contextmenu"),t.editor.selectedContainer=null)},e.prototype.getData=function(){var t=[];return this.blocks.forEach(function(e){t.push(e.getData())}),t},e.prototype.getHtml=function(){var t=[];return this.blocks.forEach(function(e){t.push(e.getHtml(!0))}),t.join("\n")},e.prototype.loadBlocks=function(t){var e=this;t&&t.length&&t.forEach(function(t){e.addBlock(t.template,t.fields)})},e.prototype.addBlock=function(e,o,i){var n=this;this.selectedBlock&&this.selectedContainer&&(n=this.selectedContainer);var r=new t.Block(this.editor,n,e,o);null==i&&null!=n.selectedBlock&&(i=n.blocks.indexOf(n.selectedBlock)+1),null!=i?(n.blocks[i-1].$editor.after(r.$editor),n.blocks.splice(i,0,r),n.selectedBlock=r):(n.$el.append(r.$editor),n.blocks.push(r)),n.selectedBlock=r,$("html, body").animate({scrollTop:r.$editor.offset().top},"fast")},e.prototype.deleteBlock=function(t){var e=this.blocks.indexOf(t);this.blocks.splice(e,1),t.$editor.remove(),t=null,this.selectedBlock=null},e.prototype.moveBlock=function(t,e){var o=this.blocks.indexOf(t),i=o+e;if(i<this.blocks.length&&i>=0){var n=this.blocks[i].$editor;e>0?n.after(t.$editor):e<0&&n.before(t.$editor),this.blocks.splice(o,1),this.blocks.splice(i,0,t)}},e.prototype.copyBlock=function(t){t.selectBlock();var e=this.blocks.indexOf(t)+1;this.addBlock(t.template,t.getData().fields,e)},e}();t.Container=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(e){function o(o,i){var n=e.call(this,o)||this;n.compactTools=null;var r=n;return n.options=new t.EditorOptions(i),r.loadTemplatesAsync().done(function(){r.loadBlocks(r.options.blocks),r.options.onload&&r.options.onload(r)}),n}return __extends(o,e),Object.defineProperty(o.prototype,"isMobile",{get:function(){return this._isMobile},set:function(e){this._isMobile!=e&&(this._isMobile=e,null!=this.$tools&&(this.$tools.toggle(!e),this.$toolsBtn.toggle(e),e?this.$tools.addClass(t.Constants.classMobile):this.$tools.removeClass(t.Constants.classMobile)))},enumerable:!0,configurable:!0}),o.prototype.loadTemplatesAsync=function(){var e=$.Deferred(),o=this,i=[];return i.push(t.Services.TemplateService.loadTemplatesAsync(o.options.templatesFolder).done(function(){}).fail(function(t){console.log("Templates loading error"),e.reject()})),i.push(t.Services.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateModalKey).done(function(e){var i=new t.Modal(e);o.modal=i,o.$el.append(i.$control)}).fail(function(t){console.log("Modal loading error"),e.reject()})),t.Services.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateToolsKey).done(function(t){o.$tools=$(t);o.$toolsBtn=$("<button class='brickyeditor-tools-show-btn'><i class='fa fa-cog'></i></button>"),o.$toolsBtn.on("click",function(){o.modal.showModal(o.$tools.clone(!0))})}).fail(function(t){console.log("Tools loading error"),e.reject()}),t.Services.TemplateService.loadTemplateAsync(o.options.templatesBaseFolder,t.Constants.templateHtmlToolsKey).done(function(e){var i=new t.HtmlTools(e,o);o.htmlTools=i,o.$el.append(i.$control)}).fail(function(t){console.log("Html Tools loading error"),e.reject()}),$.when.apply($,i).then(function(){o.addTools(),$(window).resize(function(){return o.checkIsCompactTools(o)}),e.resolve()}),e},o.prototype.addTools=function(){var e=this,o=new Array,i=$(t.Constants.selectorTemplates,e.$tools);i.hide(),e.$el.append(e.$tools),e.$el.append(e.$toolsBtn),e.checkIsCompactTools(e);for(var n in t.Services.TemplateService.templates){var r=new t.Block(null,null,n),a=t.Services.TemplateService.templates[n],l=$("<div class='template m-1 p-1' data-bricky-template=\""+n+'">'+r.getHtml(!0)+"</div>");i.append(l),a.category&&a.category.forEach(function(t){o.some(function(e){return e.breEqualsInvariant(t)})||o.push(t)})}$(t.Constants.selectorTemplate,i).on("click",function(){var t=$(this).data().brickyTemplate;e.addBlock(t)}),$(t.Constants.selectorLoader,e.$tools).fadeOut("slow",function(){i.fadeIn("fast")});var c=$("[data-brickyeditor-hide-tools]",e.$tools);c.on("click",function(){c.attr("data-brickyeditor-hide-tools")?e.isMobile?(e.$tools.hide(),e.$toolsBtn.show()):(e.$tools.animate({right:"-204px"},"fast"),c.removeAttr("data-brickyeditor-hide-tools"),c.toggleClass("fa-arrow-left").toggleClass("fa-arrow-right")):e.isMobile||(e.$tools.animate({right:"0px"},"fast"),c.attr("data-brickyeditor-hide-tools","true"),c.toggleClass("fa-arrow-left").toggleClass("fa-arrow-right"))})},o.prototype.checkIsCompactTools=function(t){if(null==t.compactTools){var e=(window.innerWidth-t.$el.width())/2-t.$tools.width();t.isMobile=e<=0}else t.isMobile=t.compactTools},o}(t.Container);t.Editor=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(t){this.templatesBaseFolder="templates",this.templatesFolder="templates/bootstrap4",this.compactTools=null,this.templatesBaseFolder=t.templatesBaseFolder||this.templatesBaseFolder,this.templatesFolder=t.templatesFolder||this.templatesFolder,this.onload=t.onload,this.blocks=t.blocks,this.compactTools=t.compactTools}return t}();t.EditorOptions=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function e(e,o){var i=this;i.$control=$(e),$(t.Constants.selectorHtmlToolsCommand,this.$control).on("click",function(){var e=$(this),n=window.getSelection(),r=n.rangeCount>0?n.getRangeAt(0):null;if(!e.is(t.Constants.selectorHtmlToolsCommandRange)||r){var a=e.data().brickyeditorDocCommand;return"CreateLink"==a?o.modal.promptAsync(i.getLinkPromptParams(n)).done(function(t){n=window.getSelection(),n.addRange(r);var e=t.getValue("href");if(e){document.execCommand(a,!1,e);var o=t.getValue("target");o&&n.anchorNode.parentElement.setAttribute("target",o);var i=t.getValue("title");i&&n.anchorNode.parentElement.setAttribute("title",i)}}).fail(function(){n=window.getSelection(),n.addRange(r)}):document.execCommand(a),!1}})}return e.prototype.getLinkPromptParams=function(e){var o="",i="",n="";if(e.anchorNode&&e.anchorNode.parentNode.nodeName.breEqualsInvariant("a")){var r=$(e.anchorNode.parentNode);o=r.attr("href"),i=r.attr("title"),n=r.attr("target")}return[new t.Prompt.PromptParameter("href","Url",o,"Url"),new t.Prompt.PromptParameter("title","Title",i,"Title"),new t.Prompt.PromptParameterOptions("target","Target",[["",""],["Blank","_blank"],["Self","_self"],["Parent","_parent"],["Top","_top"]],n)]},e}();t.HtmlTools=e}(BrickyEditor||(BrickyEditor={})),function(t){t.fn.brickyeditor=function(e){return new BrickyEditor.Editor(t(this),e)}}(jQuery),function(t){t.fn.showLinkLocation=function(){return this.filter("a").append(function(){return" ("+this.href+")"}),this}}(jQuery);var BrickyEditor;!function(t){var e=function(){function e(e){var o=this;this.$control=$(e),this.$content=$(t.Constants.selectorModalContent,this.$control),$(t.Constants.selectorModalClose,this.$control).on("click",function(){o.hideModal()})}return e.prototype.hideModal=function(){var t=this.$content;this.$control.fadeOut(function(){t.html("")})},e.prototype.showModal=function(t){this.$content.append(t),t.is(":visible")||t.show(),this.$control.fadeIn()},e.prototype.promptAsync=function(e){var o=$.Deferred(),i=this,n=$("<form></form>");e.forEach(function(t){n.append(t.$control)});var r=$('<button type="button" class="btn btn-ok m-r-1">Ok</button>');r.on("click",function(){e.forEach(function(t){return t.parseValue()}),i.hideModal(),o.resolve(new t.Prompt.PromptParameterList(e))});var a=$('<button type="button" class="btn btn-cancel">Cancel</button>');return a.on("click",function(){i.hideModal(),o.reject(e)}),n.append(r),n.append(a),i.showModal(n),o},e}();t.Modal=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(){}return t.getSelectedText=function(){return window.getSelection().getRangeAt(0).toString()},t.replaceSelectedText=function(t){var e,o;window.getSelection&&(e=window.getSelection(),e.rangeCount&&(o=e.getRangeAt(0),o.deleteContents(),o.insertNode(document.createTextNode(t))))},t}();t.SelectionHelper=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){var e=function(){function t(t){this.title=t.title,this.file=t.file,this.category=t.cactegory||[]}return t}();t.Template=e}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(){function e(e,o,i){this.block=e,this.$field=o,this.name=t.Services.TemplateService.getFieldValue(o,"name"),this.type=t.Services.TemplateService.getFieldValue(o,"type"),this.data=i||{},this.bind()}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.getField=function(e,o,i){var n=t.Services.TemplateService.getFieldValue(o,"type"),r=this.fields[n];if(r)return r(e,o,i);throw n+" field not found"},e.prototype.bind=function(){},e.prototype.selectBlock=function(t){this.block.container.selectedBlock.selectBlock(this,t)},e.prototype.getData=function(){return{type:this.type,name:this.name,data:this.data}},e}();o.fields={html:function(t,o,i){return new e.HtmlField(t,o,i)},image:function(t,o,i){return new e.ImageField(t,o,i)},embed:function(t,o,i){return new e.EmbedField(t,o,i)},container:function(t,o,i){return new e.ContainerField(t,o,i)}},e.BaseField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(o,i,n){var r=e.call(this,o,i,n)||this;return r.container=new t.Container(i,r.block.editor),r}return __extends(o,e),Object.defineProperty(o.prototype,"data",{get:function(){return this.container?this.container.getData():{}},set:function(t){this._data=t},enumerable:!0,configurable:!0}),o.prototype.bind=function(){var t=this,e=this.$field;this.data;e.on("click",function(){t.selectBlock(t.container)})},o.prototype.select=function(){this.$field.addClass("selected")},o.prototype.deselect=function(){this.$field.removeClass("selected")},o}(e.BaseField);e.ContainerField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field;this.data;o.on("click",function(){var i=prompt("Link to embed","http://instagr.am/p/fA9uwTtkSN/");t.Services.EmbedService.getEmbedAsync(i).done(function(t){e.data.url=i,e.data.embed=t;var n=$(t.html),r=n.filter("script");if(r.length>0){r.remove();var a=r.attr("src");a.breStartsWith("//")&&(a="http:"+a,$.getScript(a).done(function(t){a.breContains("instgram")&&instgrm&&instgrm.Embeds.process()}).fail(function(t){}))}o.replaceWith(n),e.selectBlock()})})},o}(e.BaseField);e.EmbedField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field,i=this.data;o.is("[contenteditable]")||o.attr("contenteditable","true"),this.data.html=this.data.html||t.Services.TemplateService.getFieldValue(o,"html")||t.Constants.dummyText,o.html(this.data.html),o.on("focus",function(){e.selectBlock()}),o.on("blur keyup paste input",function(){i.html=$(this).html().trim()}),o.on("paste",function(t){var e=t.originalEvent,o=e.clipboardData.getData("text/html");if(o){var i=$("<div></div>"),n=$(o);n.removeAttr("style"),i.append(n),e.clipboardData.setData("text/html",i.html())}})},o}(e.BaseField);e.HtmlField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.bind=function(){var e=this,o=this.$field;this.data;this.data.src||(this.data.src=t.Services.TemplateService.getFieldValue(o,"src")),o.attr("src",this.data.src),o.on("click",function(){e.block.editor.modal.promptAsync(e.getPromptParams()).done(function(t){var o=t.getValue("file"),i=t.getValue("src");o?(e.setFile(o),e.setSrc(null)):i&&(e.setSrc(i),e.setFile(null));var n=t.getValue("alt");e.setAlt(n)}),e.selectBlock()})},o.prototype.getPromptParams=function(){return[new t.Prompt.PromptParameter("src","Image Link",this.data.url,"image url"),new t.Prompt.PromptParameterImage("file","or Upload file",this.data.file,"select file"),new t.Prompt.PromptParameter("alt","Alt",this.data.alt,"alt attribute value ")]},o.prototype.setSrc=function(t){this.data.src=t,t&&this.$field.attr("src",this.data.src)},o.prototype.setAlt=function(t){this.data.alt=t,this.$field.attr("alt",this.data.alt)},o.prototype.setFile=function(t){this.data.file=t,t&&this.$field.attr("src",this.data.file.fileContent)},o}(e.BaseField);e.ImageField=o}(t.Fields||(t.Fields={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(t,e,o,i){this.key=t,this.title=e,this.placeholder=i||"",this.value=o}return t.prototype.parseValue=function(){this.value=this.$input.val(),this.$control=null,delete this._$control},Object.defineProperty(t.prototype,"$control",{get:function(){return this._$control||(this._$control=$('<div class="brickyeditor-prompt-field">\n                        <label for="'+this.key+'">'+(this.title?this.title:"")+"</label>\n                        </div>"),this.$input=this.getEditor(),this._$control.append(this.$input)),this._$control},set:function(t){this._$control=t},enumerable:!0,configurable:!0}),t.prototype.getEditor=function(){this.value;return $('<input type="text" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+'" value="'+(this.value?this.value:"")+'">')},t}();t.PromptParameter=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(e){function o(t,o,i,n){var r=e.call(this,t,o,i,n)||this;return i&&(r._value=i),r}return __extends(o,e),o.prototype.parseValue=function(){this.value=this._value,this.$control=null,delete this._$control,this._value=null,delete this._value},o.prototype.getEditor=function(){var e=this,o=this.value&&this.value.fileContent?this.value.fileContent:"",i=$("\n                <div class='brickyeditor-image-input'>\n                    <label for=\""+this.key+'">\n                        <img src="'+o+'"/>\n                    </label>                        \n                    <input type="file" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+"\">\n                </div>\n                <small class='brickyeditor-image-input-filename'></small>"),n=$("input",i),r=$("img",i),a=$(".brickyeditor-image-input-filename",i),l=this.value;return l&&(r.attr("src",l.fileContent),a.text(l.fileInfo.name)),n.change(function(){var o=this;if(o.files&&o.files[0]){var i=new FileReader;i.onload=function(i){var n=i.target;e._value=new t.PromptParameterImageResult,e._value.fileContent=n.result,e._value.fileInfo=new t.PromptParameterImageResultFile(o.files[0]),r.attr("src",e._value.fileContent),a.text(e._value.fileInfo.name)},i.readAsDataURL(o.files[0])}}),i},o}(t.PromptParameter);t.PromptParameterImage=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(){}return t}();t.PromptParameterImageResult=e;var o=function(){function t(t){this.name=t.name,this.size=t.size,this.type=t.type,this.lastModified=t.lastModified,this.lastModifiedDate=t.lastModifiedDate}return t}();t.PromptParameterImageResultFile=o}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(t){this.params=t}return t.prototype.getValue=function(t){var e=this.params.find(function(e){return e.key===t});return e?e.value:null},t}();t.PromptParameterList=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(t,e,o){void 0===o&&(o=!1),this.title=t,this.value=e,this.selected=o}return t}();t.PromptParameterOption=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(e){function o(o,i,n,r,a){var l=e.call(this,o,i,r,a)||this;return l.options=[],n.forEach(function(e){l.options.push(new t.PromptParameterOption(e[0],e[1],e[1]==r))}),l}return __extends(o,e),o.prototype.getEditor=function(){var t=this.options.map(function(t){return'<option value="'+t.value+'" '+(t.selected?"selected":"")+">"+(t.title?t.title:t.value)+"</option>"});return $('<select type="text" id="'+this.key+'" class="brickyeditor-input" placeholder="'+this.placeholder+'">'+t+"</select>")},o}(t.PromptParameter);t.PromptParameterOptions=e}(t.Prompt||(t.Prompt={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(t){var e=function(){function t(){}return t.getEmbedAsync=function(t){var e=$.Deferred(),t="https://noembed.com/embed?url="+t;return $.ajax({url:t,type:"get",dataType:"jsonp"}).done(function(t){e.resolve(t)}).fail(function(t){e.reject(t)}),e},t}();t.EmbedService=e}(t.Services||(t.Services={}))}(BrickyEditor||(BrickyEditor={}));var BrickyEditor;!function(t){!function(e){var o=function(){function e(){}return e.loadTemplateAsync=function(t,o){e.templates=[];var i=$.Deferred();return $.get(e.getTemplateUrl(t,o)).done(function(t){i.resolve(t)}).fail(function(t){i.reject(t)}),i},e.loadTemplateConfigAsync=function(t){var o=$.Deferred();return $.getJSON(e.getTemplatesConfigUrl(t)).done(function(t){o.resolve(t)}).fail(function(t){console.log(t),o.reject(t)}),o},e.filteredTemplates=function(t){e.templates.map(function(e){e.category.filter(function(e){e.toLowerCase(),t.toLowerCase()})})},e.loadTemplatesAsync=function(o){var i=$.Deferred();return e.loadTemplateConfigAsync(o).done(function(o){o.forEach(function(o){e.templates.push(new t.Template(o))})}).fail(function(t){console.log(t)}).then(function(){var t=[];e.templates.forEach(function(i){var n=e.loadTemplateAsync(o,i.file).done(function(t){i.html=t,e.templates[i.file]=i}).fail(function(t){console.log(t)});t.push(n)}),$.when.apply($,t).then(function(){i.resolve()})}),i},e.getTemplateUrl=function(t,e){return t+"/"+e+".html"},e.getTemplatesConfigUrl=function(t){return t+"/templates.json"},e.getTemplate=function(t){return e.templates[t]},e.removeTemplate=function(t){delete e.templates[t]},e.getFieldValue=function(t,e){return t.attr("data-bricky-field-"+e)},e}();e.TemplateService=o}(t.Services||(t.Services={}))}(BrickyEditor||(BrickyEditor={}));